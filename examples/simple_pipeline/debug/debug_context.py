from dagster import seven as __dm_seven
import dagstermill
import os


def load_params():
    params = {
        key: __dm_seven.json.loads(value)
        for key, value
        in {'executable_dict': '{"__class__": "ReconstructablePipeline", "asset_selection": null, "pipeline_name": "simple_pipeline", "repository": {"__class__": "ReconstructableRepository", "container_context": null, "container_image": null, "entry_point": ["dagster"], "executable_path": "/opt/conda/bin/python3.10", "pointer": {"__class__": "FileCodePointer", "fn_name": "dagstermill_pipeline", "python_file": "/home/jovyan/work/dev/dsml4s8e/examples/simple_pipeline/dag/dag.py", "working_directory": "/home/jovyan/work/dev/dsml4s8e/examples/simple_pipeline/dag"}, "repository_load_data": null}, "solid_selection_str": null, "solids_to_execute": null}', 'pipeline_run_dict': '{"__class__": "PipelineRun", "asset_selection": null, "execution_plan_snapshot_id": "32c60f2740c1f7af51351dfb9af6cf348567dd9b", "external_pipeline_origin": {"__class__": "ExternalPipelineOrigin", "external_repository_origin": {"__class__": "ExternalRepositoryOrigin", "repository_location_origin": {"__class__": "ManagedGrpcPythonEnvRepositoryLocationOrigin", "loadable_target_origin": {"__class__": "LoadableTargetOrigin", "attribute": null, "executable_path": null, "module_name": null, "package_name": null, "python_file": "/home/jovyan/work/dev/dsml4s8e/examples/simple_pipeline/dag/dag.py", "working_directory": "/home/jovyan/work/dev/dsml4s8e/examples/simple_pipeline/dag"}, "location_name": "dag.py"}, "repository_name": "__repository__simple_pipeline"}, "pipeline_name": "simple_pipeline"}, "has_repository_load_data": false, "mode": "default", "parent_run_id": "8f67c215-b61f-4493-9d55-acac97126b56", "pipeline_code_origin": {"__class__": "PipelinePythonOrigin", "pipeline_name": "simple_pipeline", "repository_origin": {"__class__": "RepositoryPythonOrigin", "code_pointer": {"__class__": "FileCodePointer", "fn_name": "dagstermill_pipeline", "python_file": "/home/jovyan/work/dev/dsml4s8e/examples/simple_pipeline/dag/dag.py", "working_directory": "/home/jovyan/work/dev/dsml4s8e/examples/simple_pipeline/dag"}, "container_context": {}, "container_image": null, "entry_point": ["dagster"], "executable_path": "/opt/conda/bin/python3.10"}}, "pipeline_name": "simple_pipeline", "pipeline_snapshot_id": "de0434c25d6b62a4db51dcc0fad02dae93228bc3", "root_run_id": "8f67c215-b61f-4493-9d55-acac97126b56", "run_config": {"ops": {"nb_1": {"config": {"a": 33}}}}, "run_id": "75e01ef5-d022-4aed-94b7-45ca03f4bfbb", "solid_selection": null, "solids_to_execute": null, "status": {"__enum__": "PipelineRunStatus.STARTING"}, "step_keys_to_execute": ["nb_2"], "tags": {".dagster/grpc_info": "{\\"host\\": \\"localhost\\", \\"socket\\": \\"/tmp/tmpxaq2nu4c\\"}", "cdlc_stage": "dev", "dagster/parent_run_id": "8f67c215-b61f-4493-9d55-acac97126b56", "dagster/root_run_id": "8f67c215-b61f-4493-9d55-acac97126b56", "dagster/solid_selection": "*", "dagster/step_selection": "\\"nb_2\\""}}', 'node_handle_kwargs': '{"name": "nb_2", "parent": null}', 'instance_ref_dict': '{"__class__": "InstanceRef", "compute_logs_data": {"__class__": "ConfigurableClassData", "class_name": "LocalComputeLogManager", "config_yaml": "base_dir: /home/jovyan/work/dagster_home/storage\\n", "module_name": "dagster.core.storage.local_compute_log_manager"}, "custom_instance_class_data": null, "event_storage_data": {"__class__": "ConfigurableClassData", "class_name": "SqliteEventLogStorage", "config_yaml": "base_dir: /home/jovyan/work/dagster_home/history/runs/\\n", "module_name": "dagster.core.storage.event_log"}, "local_artifact_storage_data": {"__class__": "ConfigurableClassData", "class_name": "LocalArtifactStorage", "config_yaml": "base_dir: /home/jovyan/work/dagster_home\\n", "module_name": "dagster.core.storage.root"}, "run_coordinator_data": {"__class__": "ConfigurableClassData", "class_name": "DefaultRunCoordinator", "config_yaml": "{}\\n", "module_name": "dagster.core.run_coordinator"}, "run_launcher_data": {"__class__": "ConfigurableClassData", "class_name": "DefaultRunLauncher", "config_yaml": "{}\\n", "module_name": "dagster"}, "run_storage_data": {"__class__": "ConfigurableClassData", "class_name": "SqliteRunStorage", "config_yaml": "base_dir: /home/jovyan/work/dagster_home/history/\\n", "module_name": "dagster.core.storage.runs"}, "schedule_storage_data": {"__class__": "ConfigurableClassData", "class_name": "SqliteScheduleStorage", "config_yaml": "base_dir: /home/jovyan/work/dagster_home/schedules\\n", "module_name": "dagster.core.storage.schedules"}, "scheduler_data": {"__class__": "ConfigurableClassData", "class_name": "DagsterDaemonScheduler", "config_yaml": "{}\\n", "module_name": "dagster.core.scheduler"}, "secrets_loader_data": null, "settings": {}, "storage_data": {"__class__": "ConfigurableClassData", "class_name": "DagsterSqliteStorage", "config_yaml": "base_dir: /home/jovyan/work/dagster_home\\n", "module_name": "dagster.core.storage.sqlite_storage"}}', 'step_key': '"nb_2"', 'output_log_path': '"/tmp/tmpijsa5wmn"', 'marshal_dir': '"/tmp/dagstermill/75e01ef5-d022-4aed-94b7-45ca03f4bfbb/marshal"', 'run_config': '{"ops": {"nb_1": {"config": {"a": 33}}}}'}.items()
    }
    return params


def reconstitute_pipeline_contex(params):
    context = dagstermill._reconstitute_pipeline_context(**params)
    return context


if __name__ == '__main__':
    params = load_params()
    os.chdir(params['executable_dict']['repository']['pointer']['working_directory'])
    print(os.getcwd())
    context = reconstitute_pipeline_contex(params)
    url_nb_1_data1 = dagstermill._load_input_parameter('url_nb_1_data1')
    print(url_nb_1_data1)
