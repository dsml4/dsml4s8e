
# dsml4s8e
**D**ata **S**cience / **ML** flow(**4**) **s**tandalon(**8**)**e**


dsml4s8e is a python library that aims to:
 1. Simplify building of Dagster pipelines from **standalon** notebooks
 2. Standardize a structure of ML/DS a pipeline project to easy sharing
 3. Manage experiments data and artefacts

It makes possible following workflow:
 1. Define a project structure for your pipeline and a structure of the pipeline catalog
 2. Develop **standalon** Jupyter notebooks with clear interface
 3. Loade the notebooks into dagit (build a pipeline)
 4. Configure and run the pipeline many times in vary environments and on vary infrastructure 

![op_parameters_cell](https://user-images.githubusercontent.com/1010096/221004539-a13f6dac-056c-4633-94bf-ef995c857da8.png)

![op_parameters_cell](https://user-images.githubusercontent.com/1010096/221832042-f1129a96-45eb-4678-a541-cab8c9e72c89.png)

A cell tagged 'op_parameters' responsible for integration standalone notebook with Dagster. In a load stage dictionary of parameters from this cell is trasformed to dagstermill format and sets to fuction define_dagstermill_op from dagstermill library to make parameters avalible in Dagster Launchpad to edit run configuration. 

![nb_1](https://user-images.githubusercontent.com/1010096/221655435-3b01fb49-7ff9-4e53-82b8-ad0922fc2136.png)


A cell tagged 'parameters' response for set a notebook run configuration.

Variables declared in this cell are used in class NBInterface.
The function
```python 
get_context
```
set default values from config_schema in cell 'op_parameters' to context
```python
# pass context.op_config
context = dagstermill.get_context(op_config=
                                  dag_params.get_op_config(op_parameters)
                                 )
```
If the notebook is run by Dagster orchestrator then tagget 'parameter' cell replace with tagget 'injected-parameters' cell generated by Dagster.


![injected](https://user-images.githubusercontent.com/1010096/221841608-8f0b51a9-c3ff-4152-a8f5-33feac4eb9aa.png)

LoacalStorageCatalog class resposible for structure of data catalog it is fully customizable.

```python
# in dag.py pipeline code

from dagstermill import define_dagstermill_op
from dsml4s8e.extract_dag_params_from_nb import get_dagstermill_op_params


op_1_params = get_dagstermill_op_params("/home/jovyan/work/dev/pipeline_example/data_load/nb_1.ipynb")
op1 = define_dagstermill_op(**op_1_params,
                            save_notebook_on_failure=True)


op_2_params = get_dagstermill_op_params("/home/jovyan/work/dev/pipeline_example/data_load/nb_2.ipynb")
op2 = define_dagstermill_op(**op_2_params,
                            save_notebook_on_failure=True)

```

![Job_dagstermill_pipeline](https://user-images.githubusercontent.com/1010096/221005076-7ba56646-8a9e-4d75-bbaf-e68ba04d036d.svg)


  
